#!/bin/sh

. /home/engines/functions/checks.sh\r\nrequired_values=\"log_file_path parent_engine cycle rotate\"\r\ncheck_required_values\r\n\r\n\r\nif ! test -d  /home/logrotate/saved/$parent_engine/\r\n then\r\n    mkdir -p /home/logrotate/saved/$parent_engine/\r\nfi\r\n\r\nif test -z $service_handle\r\n then\r\n   service_handle=`basename $log_file_path`\r\nfi\r\n\r\necho \"/var/log/engines/$log_file_path{\" > /home/logrotate/saved/$parent_engine/$service_handle.entry\r\ncat /home/logrotate/tmpls/log_rotation_entry | sed \"/ROTATE/s//$rotate/\" |\\\r\n                sed    \"/CYCLE/s//$cycle/\"  >> /home/logrotate/saved/$parent_engine/$service_handle.entry\r\n\r\n\r\ncat /home/logrotate/saved/$parent_engine/*entry > /home/logrotate/conf.d/$parent_engine\r\n\r\nsudo -n /home/engines/scripts/services/sudo/add_service.sh $parent_engine
